# 接続エラーのトラブルシューティング

## エラーメッセージ

- "there was a problem running the requested app"
- "unknown error could not connect to the server"

これらのエラーは、**PCとスマートフォンが接続できていない**ことを示しています。

## 確認手順

### ステップ1: ターミナルの状態を確認

`npm start`を実行しているターミナルで、以下のようなメッセージが表示されているか確認：

```
› Metro waiting on exp://192.168.x.x:8083
```

または

```
› Metro bundler is running
```

**エラーメッセージが表示されている場合、その内容を確認してください。**

### ステップ2: PCとスマートフォンが同じWi-Fiに接続されているか確認

**これが最も重要なポイントです！**

1. **PCのWi-Fi接続を確認**
   - Windowsの設定で、どのWi-Fiネットワークに接続されているか確認

2. **スマートフォンのWi-Fi接続を確認**
   - 設定アプリで、どのWi-Fiネットワークに接続されているか確認

3. **同じネットワークか確認**
   - PCとスマートフォンが**完全に同じWi-Fiネットワーク**に接続されている必要があります
   - 例: 両方とも「MyWiFi-5G」に接続されている

### ステップ3: PCのIPアドレスを確認

1. **PowerShellでIPアドレスを確認**
   ```powershell
   ipconfig
   ```

2. **表示されたIPアドレスを確認**
   - 「IPv4 アドレス」の行を探す
   - 例: `192.168.1.100`

3. **ターミナルのURLと一致しているか確認**
   - ターミナルに表示されているURLのIPアドレスが、`ipconfig`で表示されたIPアドレスと一致しているか確認

### ステップ4: ファイアウォールの設定を確認

Windowsファイアウォールがポート8083をブロックしている可能性があります。

1. **Windowsファイアウォールの設定を開く**
   - 「Windows セキュリティ」→「ファイアウォールとネットワーク保護」

2. **ポート8083が許可されているか確認**
   - または、一時的にファイアウォールを無効化してテスト

### ステップ5: URLを手動で構築して入力

ターミナルにURLが表示されていない場合、手動で構築できます：

1. **PCのIPアドレスを確認**（`ipconfig`コマンドで）
2. **URLを構築**: `exp://[IPアドレス]:8083`
   - 例: `exp://192.168.1.100:8083`
3. **Expo Goアプリで「Enter URL manually」を探してURLを入力**

## 解決方法

### 方法1: Wi-Fi接続を確認して再接続

1. PCとスマートフォンを**同じWi-Fiネットワーク**に接続
2. `npm start`を再起動
3. 新しいURLで再度接続

### 方法2: ポートを変更して再試行

1. **別のポートで起動**
   ```bash
   npx expo start --clear --port 8084
   ```

2. **新しいURLで接続**
   - ターミナルに表示された新しいURLを使用

### 方法3: ローカルホストを使用（同じデバイスで実行している場合）

スマートフォンとPCが同じデバイスの場合（例: エミュレーター）：

1. **ローカルホストで起動**
   ```bash
   npx expo start --localhost
   ```

2. **URLを確認**
   - `exp://localhost:8083`または`exp://127.0.0.1:8083`

### 方法4: トンネルモードを使用（Wi-Fi接続が難しい場合）

1. **トンネルモードで起動**
   ```bash
   npx expo start --tunnel
   ```

2. **表示されたURLで接続**
   - トンネルモードでは、インターネット経由で接続できるため、同じWi-Fiに接続する必要がありません

## デバッグコマンド

### ターミナルで実行

```bash
# キャッシュをクリアして再起動
npx expo start --clear

# 別のポートで起動
npx expo start --clear --port 8084

# トンネルモードで起動（Wi-Fi接続が難しい場合）
npx expo start --tunnel

# ローカルホストモード（同じデバイスの場合）
npx expo start --localhost
```

## 確認事項チェックリスト

- [ ] PCとスマートフォンが同じWi-Fiネットワークに接続されている
- [ ] ターミナルに`Metro waiting on exp://...`が表示されている
- [ ] PCのIPアドレスがターミナルのURLと一致している
- [ ] ファイアウォールがポートをブロックしていない
- [ ] `npm start`が正常に実行されている（エラーがない）

## 次のステップ

1. **上記のチェックリストを確認**
2. **ターミナルの状態を確認**（エラーメッセージがないか）
3. **PCのIPアドレスを確認**（`ipconfig`コマンドで）
4. **トンネルモードを試す**（Wi-Fi接続が難しい場合）

## トンネルモードの使い方（推奨）

Wi-Fi接続の問題を回避するために、トンネルモードを使用することをお勧めします：

```bash
npx expo start --tunnel
```

これにより、インターネット経由で接続できるため、同じWi-Fiに接続する必要がありません。
