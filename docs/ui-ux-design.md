# UI/UX設計書：Baker's Lens

## 1. デザイン原則

### 1.1 基本方針

- **シンプルで直感的**: 粉だらけの手でも操作しやすいUI
- **情報の階層化**: 重要な情報（微量材料など）を強調表示
- **リアルタイムフィードバック**: 操作に対して即座に視覚的フィードバック
- **アクセシビリティ**: 視認性の高いコントラスト、適切なタップ領域

### 1.2 カラーパレット

```
プライマリカラー:
- メイン: #FF6B35 (オレンジ) - アクション、強調
- セカンダリ: #004E89 (ブルー) - 情報表示

ニュートラル:
- 背景: #FFFFFF (白)
- 表面: #F5F5F5 (ライトグレー)
- テキスト: #212121 (ダークグレー)
- ボーダー: #E0E0E0 (ライトグレー)

ステータス:
- 成功: #4CAF50 (グリーン)
- 警告: #FF9800 (オレンジ)
- エラー: #F44336 (レッド)
- 情報: #2196F3 (ブルー)

計量済み:
- グレーアウト: #9E9E9E (ミディアムグレー)
- 背景: #F5F5F5 (ライトグレー)
```

## 2. 画面構成

### 2.1 画面一覧

1. **スプラッシュ画面** - アプリ起動時
2. **カメラ画面** - OCRスキャン
3. **レシピ編集画面** - 材料リストとスケーリング
4. **レシピ一覧画面** - 保存済みレシピ
5. **設定画面** - アプリ設定

### 2.2 ナビゲーション構造

```
┌─────────────────────────────────────────────┐
│     Header              [⚙️ 設定アイコン]  │  ← ヘッダー右に設定ボタン
├─────────────────────────────────────────────┤
│                                             │
│              画面コンテンツ                  │
│                                             │
├─────────────────────────────────────────────┤
│     Bottom Tab Navigator                    │
│  [📷 スキャン] [🧮 計算] [📖 保存]          │
└─────────────────────────────────────────────┘

Stack Navigator
├─ MainTabs (Bottom Tabs)
│   ├─ Camera (スキャン)      → CameraScreen
│   ├─ Edit (計算)            → RecipeEditScreen
│   └─ Recipes (保存)         → RecipeListScreen
│
└─ Settings (設定)            → SettingsScreen
    ※ ヘッダーの歯車アイコンから遷移
```

## 3. 画面詳細設計

### 3.1 スプラッシュ画面

**目的**: アプリ起動時の初期化とブランディング

**要素**:
- アプリロゴ
- ローディングインジケーター
- バージョン情報（オプション）

**遷移**:
- 初期化完了後 → カメラ画面（初回起動時）またはレシピ一覧画面

### 3.2 カメラ画面（CameraScreen）【実装済み】

**目的**: レシピ画像の撮影/選択とOCRスキャン

**レイアウト**:
```
┌─────────────────────────────────┐
│  スキャン              [⚙️]    │ ← ヘッダー
├─────────────────────────────────┤
│                                 │
│    [📷 撮影された画像の        │
│        プレビュー表示]          │ ← 画像プレビュー
│                                 │
├─────────────────────────────────┤
│    認識された材料: 5件          │
│    ─────────────────────        │
│    ✓ 強力粉 250g               │
│    ✓ 水 150ml                  │
│    ...                          │ ← OCR結果リスト
├─────────────────────────────────┤
│  [📷 カメラで撮影]              │
│  [🖼️ ライブラリから選択]        │ ← 画像選択ボタン
│  [✓ この結果を使用]             │ ← 確定ボタン
└─────────────────────────────────┘
```

**主要コンポーネント**:

1. **画像プレビュー**
   - 撮影/選択した画像のプレビュー表示
   - OCR処理中はローディング表示

2. **OCR結果リスト**
   - 認識された材料の一覧表示
   - 認識件数の表示

3. **画像選択ボタン**
   - 「カメラで撮影」: expo-image-pickerでカメラ起動
   - 「ライブラリから選択」: フォトライブラリから選択

4. **確定ボタン**
   - 「この結果を使用」: RecipeEditScreenへ遷移

**インタラクション**:
- 画像選択 → OCR処理開始 → 結果表示
- 「この結果を使用」タップ → 計算画面へ遷移

#### 将来実装予定（Phase 2 - Development Build）

**リアルタイムカメラ画面**:
```
┌─────────────────────────────────┐
│  [戻る]        [設定]           │ ← ヘッダー
├─────────────────────────────────┤
│                                 │
│      [カメラプレビュー]         │
│      + ARオーバーレイ           │ ← メインエリア
│                                 │
├─────────────────────────────────┤
│  [撮影]  [OCR開始]  [停止]      │ ← コントロール
└─────────────────────────────────┘
```

- Vision Cameraによるリアルタイムプレビュー
- Skiaによる60FPS ARオーバーレイ描画

### 3.3 レシピ編集画面（RecipeEditScreen）【実装済み】

**目的**: 材料リストの表示・編集とスケーリング操作

**レイアウト**:
```
┌─────────────────────────────────┐
│  計算                   [⚙️]    │ ← ヘッダー
├─────────────────────────────────┤
│  タイトル: [____________]       │ ← タイトル入力
├─────────────────────────────────┤
│  スケーリング                   │
│  ┌─────────────────────────┐   │
│  │  [-]    1.0x     [+]     │   │ ← +/-ボタン
│  └─────────────────────────┘   │
├─────────────────────────────────┤
│  材料リスト:                    │
│  ☑ 強力粉     250g  [🔒]       │ ← 材料アイテム
│  ☐ 水         150ml            │
│  ☐ 塩         5g               │
│  ☐ イースト   3g               │
├─────────────────────────────────┤
│  [保存]                         │ ← 保存ボタン
└─────────────────────────────────┘
```

**主要コンポーネント**:

1. **TitleInput**
   - レシピタイトルの入力フィールド
   - プレースホルダー: "レシピ名を入力"

2. **ScalingControls**【実装済み】
   - +/-ボタンによる倍率調整
   - 範囲: 0.1倍 ～ 10.0倍
   - 現在の倍率を表示

3. **IngredientList**【実装済み】
   - 材料リストの表示
   - 各アイテム:
     - チェックボックス（計量済み）
     - 材料名
     - 分量（計算後）
     - 単位
     - ロックボタン

4. **SaveButton**【実装済み】
   - Supabaseへのレシピ保存

**インタラクション**:
- +/-ボタン操作: 全材料の分量を即時更新
- チェックボックス: 計量済み材料をグレーアウト
- ロックボタン: 材料の分量を固定

#### 将来追加予定（Phase 2）

- **ScalingSlider**: ドラッグ操作での倍率調整
- **BaseIngredientSelector**: 基準材料の選択ドロップダウン
- **TimerButton**: 抽出時間からのタイマー起動
- **BakersPercentButton**: ベーカーズパーセント表示切替
- **微量材料アラート**: 塩・イーストなどの強調表示

### 3.4 レシピ一覧画面（RecipeListScreen）【実装済み】

**目的**: 保存済みレシピの一覧表示と管理

**レイアウト**:
```
┌─────────────────────────────────┐
│  保存レシピ             [⚙️]    │ ← ヘッダー
├─────────────────────────────────┤
│  ┌───────────────────────────┐ │
│  │ 基本のパン                │ │ ← レシピカード
│  │ 2026/01/28                │ │
│  │ [★] [編集] [削除]        │ │
│  └───────────────────────────┘ │
│  ┌───────────────────────────┐ │
│  │ 全粒粉パン                │ │
│  │ 2026/01/27                │ │
│  │ [☆] [編集] [削除]        │ │
│  └───────────────────────────┘ │
├─────────────────────────────────┤
│                                 │
│     レシピがありません         │ ← 空状態
│     [カメラでスキャン]          │
│                                 │
└─────────────────────────────────┘
```

**主要コンポーネント**:

1. **RecipeCard**【実装済み】
   - タイトル
   - 作成日時
   - お気に入りボタン
   - アクションボタン（編集・削除）

2. **EmptyState**【実装済み】
   - レシピがない場合の表示
   - 「カメラでスキャン」ボタン

**インタラクション**:
- カードタップ: レシピ編集画面を開く
- お気に入りボタン: お気に入りの追加/削除
- 削除ボタン: 確認ダイアログ → 削除

#### 将来追加予定（Phase 2）

- **サムネイル画像**: OCR元画像の表示
- **SearchBar**: レシピタイトルでの検索

### 3.5 設定画面（SettingsScreen）【実装済み】

**目的**: アプリ設定の管理

**アクセス方法**: ヘッダー右の歯車アイコン（⚙️）からスタック遷移

**レイアウト**:
```
┌─────────────────────────────────┐
│  [←] 設定                        │ ← ヘッダー（戻るボタン付き）
├─────────────────────────────────┤
│  計算設定                        │
│  ┌───────────────────────────┐   │
│  │ 丸めモード                │   │
│  │ [整数] [小数]             │   │ ← トグル
│  └───────────────────────────┘   │
├─────────────────────────────────┤
│  その他                          │
│  ┌───────────────────────────┐   │
│  │ バージョン情報            │   │
│  └───────────────────────────┘   │
└─────────────────────────────────┘
```

**主要コンポーネント**:

1. **丸めモード設定**【実装済み】
   - 整数表示 / 小数表示の切り替え

#### 将来追加予定（Phase 2）

- **ARオーバーレイ ON/OFF**: トグル設定
- **小数点桁数設定**: 1桁/2桁の選択
- **アカウント**: ログイン/ログアウト
- **利用規約・プライバシーポリシー**: リンク

## 4. コンポーネント設計

### 4.1 共通コンポーネント

#### Button

```typescript
interface ButtonProps {
  title: string
  onPress: () => void
  variant?: 'primary' | 'secondary' | 'outline'
  size?: 'small' | 'medium' | 'large'
  disabled?: boolean
  icon?: React.ReactNode
}
```

#### Input

```typescript
interface InputProps {
  value: string
  onChangeText: (text: string) => void
  placeholder?: string
  label?: string
  error?: string
  keyboardType?: 'default' | 'numeric' | 'decimal'
}
```

#### Slider

```typescript
interface SliderProps {
  value: number
  onValueChange: (value: number) => void
  minimumValue: number
  maximumValue: number
  step?: number
  showValue?: boolean
}
```

### 4.2 レシピ関連コンポーネント

#### IngredientItem

```typescript
interface IngredientItemProps {
  ingredient: Ingredient
  onToggleCheck: () => void
  onLock: () => void
  onEdit: () => void
  isBase?: boolean
  showBakersPercent?: boolean
}
```

**表示内容**:
- チェックボックス
- 材料名（微量材料は警告アイコン付き）
- 分量（計算後、強調表示）
- 単位
- ロックボタン（オプション）
- ベーカーズパーセント（オプション）

## 5. ユーザーフロー

### 5.1 新規レシピ作成フロー【実装済み】

```
1. スキャンタブを開く
2. 「カメラで撮影」または「ライブラリから選択」をタップ
3. レシピ画像を撮影/選択
4. OCR処理が自動実行される
5. 認識された材料一覧が表示される
6. 「この結果を使用」ボタンをタップ
7. 計算画面でタイトルを入力
8. +/-ボタンで分量を調整
9. 「保存」ボタンをタップ
10. 保存レシピ一覧に追加される
```

### 5.2 既存レシピ編集フロー

```
1. レシピ一覧画面を開く
2. 編集したいレシピカードをタップ
3. レシピ編集画面が開く
4. 基準材料を変更またはスライダーで調整
5. 材料をチェック（計量済み）
6. 「保存」ボタンをタップ
7. 変更が保存される
```

### 5.3 計量支援フロー

```
1. レシピ編集画面を開く
2. 材料リストを確認
3. 計量した材料をチェック
4. チェック済み材料はグレーアウト表示
5. 残りの材料を確認しながら計量
6. 全ての材料を計量完了
```

## 6. エラー状態のUI

### 6.1 OCRエラー

**表示**:
- エラーメッセージ: "テキストを認識できませんでした"
- アクション: 「再試行」ボタン、「手動入力」ボタン

### 6.2 ネットワークエラー

**表示**:
- エラーメッセージ: "ネットワークに接続できません"
- オフライン状態の表示
- オフラインキューに保存された操作の表示

### 6.3 保存エラー

**表示**:
- エラーメッセージ: "レシピの保存に失敗しました"
- アクション: 「再試行」ボタン

## 7. アニメーション・トランジション

### 7.1 画面遷移

- デフォルト: スライドアニメーション
- モーダル: フェードイン・アウト

### 7.2 インタラクティブアニメーション

- スライダー操作: 数値のリアルタイム更新アニメーション
- チェックボックス: チェック時のフェードアニメーション
- ARオーバーレイ: 数値変更時のフェードアニメーション

## 8. アクセシビリティ

### 8.1 対応項目

- **スクリーンリーダー**: VoiceOver（iOS）、TalkBack（Android）対応
- **コントラスト比**: WCAG AA準拠（4.5:1以上）
- **タップ領域**: 最小44x44pt
- **フォントサイズ**: システム設定に準拠

### 8.2 アクセシビリティラベル

```typescript
// 例: 材料アイテム
<IngredientItem
  accessibilityLabel={`${ingredient.name} ${ingredient.amount}${ingredient.unit}`}
  accessibilityHint="ダブルタップで計量済みにマーク"
  accessibilityRole="button"
/>
```

## 9. レスポンシブデザイン

### 9.1 画面サイズ対応

- **小さい画面**（iPhone SE等）: フォントサイズ調整、パディング縮小
- **大きい画面**（iPad等）: 2カラムレイアウト検討

### 9.2 向き対応

- **縦向き**: デフォルトレイアウト
- **横向き**: カメラ画面は横向き推奨、レシピ編集画面は縦向き維持

## 10. パフォーマンス最適化

### 10.1 レンダリング最適化

- フラットリストの使用（FlatList）
- 仮想化による大量データの効率的な表示
- メモ化による再レンダリングの最小化

### 10.2 画像最適化

- サムネイル画像の使用
- 遅延読み込み
- キャッシュ戦略
